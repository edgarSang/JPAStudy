## 7 컨피그맵과 시크릿: 애플리케이션 설정
### 7.1. 컨테이너화된 애플리케이션 설정
 - 쿠버안에 실행되는 애플리케이션에 설정 데이터 전달 방법
 - 그전에 컨테이너화 된 앱이 어떻게 구성되는지 살펴보자
 - 일반적으로 명령줄 인수로 설정 넘김가능 설정할 옵션 목록이 커지면 설정을 파일에 저장하고 사용 할 수 있다.
 - 설정데이터를 저장하는 쿠버네티스 리소스를 컨피그 맵 이라고한다.
 - 컨피그 맵을 사용해 설정데이터를 저장할지 여부에 관계 없이 다음 방법을 통해 에플리케이션을 구성할 수 있다.
    - 컨테이너에 명령줄 인수 전달
    - 각 컨테이너를 위한 사용자 정의 환경변수 지정
    - 특수한 유형의 볼륨을 통해 설정 파일은 컨테이너에 마운트
 - 보안정보 취급을위해 쿠버네티스는 시크릿이라는 중요한 오브젝트를 제공한다

### 7.2. 컨테이너에 명령줄 인자 전달
 - 쿠버는 파드 컨테이너 정의에 지정된 실행 명령대신 다른 실행파일을 실행하거나 다른 명령줄 인자를 사용해 실행하는 것이 가능하다
#### 7.2.1 도커에서 명령어와 인자정의
 - ENTRYPOINT는 컨테이너가 시작될때 호출될 명령어를 정의한다
 - CMD는 ENTRYPOINT에 전달된 인자를 정의한다

```
  docker run <image> # 아무런 인자 지정않고 이미지 - CMD 물고 실행
  docker run <image> <arguments> # CMD에 정의된 값 재지정
```

#### 7.2.2. 쿠버네티스에서 명령과 인자 재정의
 - 컨테이너 정의시 ENTRYPOINT와 CMD 둘 다 재정의할 수 있다.

### 7.3 컨테이너의 환경변수 설정
 - 각 컨테이너를 위한 환경변수 리스트를 지정 할 수 있다.
 - 파드 수준에서 환경변수를 설저아고 컨테이너에서 상속받는것도 유용하지만 지금은 이러한 옵션이없다.

#### 7.3.1. 컨테이너 정의에 환경변수 지정
 - 환경변수는 파드레벨이아닌 컨테이너 정의안에 설정한다.
 
#### 7.3.2. 변수값에서 다른 환경변수 참조
 - $(var) 구문을 사용해 이미 정의된 환경변수나 기타 기존변수를 참조할 수도 있다.

#### 7.3.3 하드코딩된 환경변수의 단점
 - 하드코딩 됐을경우 프로덕션과 개발을 위해 서로 분리된 파드가 필요하다는 의미
 
### 7.4 컨피그맵으로 설정 분리
 - 자주 변경되는 설정옵션을 애플리케이션 소스코드와 별도로 유지하는 것이다.
 - 만약 파드의 정의를 APP의 소스코드로 생각한다면 (MSA안에서 파드정의가 실제로 그러하다.) 설정을 파드 정의에서 밖으로 이동시켜야함

#### 7.4.1 컨피그맵 소개
 - 설접옵션을 컨피그맵이라 부르는 별도 오브젝트로 분리 할 수 있다.
 - 컨피그맵은 짧은 문자열에서 전체 설정파일에 이르는 값을 가지는 키/값 쌍으로 구성된 맵이다.
 - APP은 필요한 경우 쿠버네티스 REST API 엔드포인트를 통해 컨피그맵의 내용을 직접 읽을 수 있지만, 애플리케이션은 쿠버와 무관하도록 유지해야한다.
 - 컨피그맵에 관한 여러 매니페스트를 유지할 수 있다. 파드는 컨피그맵을 이름으로 참조하기 때문에, 모든환경에 동일한 파드 정의를 사용해 환경에서 서로다른 설정을 사용 할 수있다.

#### 7.4.2. 컨피그맵 생성
 - 다음과 같은 명령으로 configmap을 사용 할 수있다
```
   kubectl create configmap 
```
``` 
   kubectl create -f fortune-config.yaml
```

#### 디렉터리에 있는 파일로 컨피그맵 생성
```
   kubectl create configmap my-config --from-file=/path/to/dir
```
#### 다양한 옵션 결함
 - 컨피그맵을 생성할때 지금까지 언급한 모든 옵션을 조합해 사용 할 수 있다.
``` 
   kubectl create configmap my-config
   touch my-config
   --form-file=foo.json
   --from-file=bar=foobar.conf
   --from-file=config-opts/
   --from-literal=some=thing
```

#### 7.4.3 컨피그맵 항목을 환경변수로 컨테이너에 전달
 - 파드로 컨테이너로 전다하는 방법은 세가지 옵션이 있다.
 - 가장 간단한 환경변수를 설정하는 것부터 시작하자, 이를위해 valueFrom 필드를 사용한다.
 - 
